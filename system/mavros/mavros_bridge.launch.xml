<launch>

    <arg name="vehicle_namespace" default="$(env VEHICLE_NAMESPACE vehicle_$(env MAVROS_TGT_SYSTEM))" />
    <arg name="firmware" default="$(env MAVROS_TGT_FIRMWARE)" />
    <arg name="fcu_url" default="$(env MAVROS_FCU_URL)"/>
    <arg name="gcs_url" default="$(env MAVROS_GCS_URL)" />
    <arg name="target_system" default="$(env MAVROS_TGT_SYSTEM)" />
    <arg name="system_id" default="$(env MAVROS_TGT_SYSTEM)" />
    <arg name="config_yaml" default="$(env MAVROS_MOD_CONFIG_PATH)"/>
    <arg name="pluginlists_yaml" default="$(env MAVROS_PLUGINLISTS_PATH)"/>

    <!-- Launch the ROS1 stack -->
    <executable cmd="/ros_ws/scripts/run_ros1.sh roslaunch /ros_ws/launch/mavros.launch
            vehicle_namespace:=$(var vehicle_namespace)
            firmware:=$(var firmware)
            fcu_url:=$(var fcu_url)
            gcs_url:=$(var gcs_url)
            target_system:=$(var target_system)
            system_id:=$(var system_id)
            config_yaml:=$(var config_yaml)
            pluginlists_yaml:=$(var pluginlists_yaml)"
        output="screen"
    />

    <!-- Launch the bridge in the correct namespace to avoid collisions-->
    <group>
        <push-ros-namespace namespace="$(var vehicle_namespace)"/>
        <node pkg="ros1_bridge" exec="dynamic_bridge" args="--bridge-all-topics" />
    </group>


</launch>